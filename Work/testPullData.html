<!DOCTYPE html>
<html>
<head></head>
<body>
<div>Attempting to pull data with AJAX and export as csv</div>
<script>
var xhttp = new XMLHttpRequest();
var blob;
var csvString;
xhttp.onreadystatechange = function(){
if(xhttp.readyState == 4){
	blob = xhttp.responseText;
	var blobj = JSON.parse(blob);
	console.log(blobj);
	for(i=0;i<blobj.myMainObject.length;i++){
		var tempRow = "Main Object,"+blobj.myMainObject[i].name+"\n";
		csvString+=tempRow;
	}
};
console.log(csvString);
}
xhttp.open("GET","https://grendelsson.github.io/Work/testData");
xhttp.setRequestHeader("Content-Type", "text/html");
xhttp.send();
var dlBlob = new Blob([csvString],{type: 'text/csv;charset=utf-8;' });
var myLink = document.createElement("a");
	
                var url = URL.createObjectURL(dlBlob);
                link.setAttribute("href", url);
	myLink.setAttribute("download", "myDL");
                document.body.appendChild(myLink);
                myLink.click();
                document.body.removeChild(myLink);
</script>
</body>
</html>
