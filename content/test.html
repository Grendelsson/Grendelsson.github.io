<!DOCTYPE html>
<html>
<head>
<meta name="robots" content="noindex">
<script src="//js.jotform.com/JotFormCustomWidget.min.js"></script>
<script type="text/javascript">
  function postUp(val){
    console.log('using callbacks');
    window.top.postMessage(val,'*');
  }
  function getAndPost(){
    window.addEventListener('message',(msg) =>{
      if(msg.data.type == 'submit'){
        postUp(msg.data);
      }
    });
  }
  getAndPost();
  var  submitCallback = function(){
    var msg = {};
    //this part will be used if your field is required. If your widget is required valid
    //property will be expected before form can be submitted
    msg.valid = true;
    //this is your field msg. You are expected to send value property as string
    msg.value = "my precious data";
    // debugging
    console.log('submit callback');
    var val = {
      'submit': msg
    }
    postUp('test post to top');
    //most probably you will call sendSubmit method
    JFCustomWidget.sendSubmit(msg);
  }
  // Actual stuff
  var readyCallback = function(){
    console.log("ready message arrived from JotForm");
    JFCustomWidget.subscribe("submit", submitCallback());
  }
  //subscribe to ready
  JFCustomWidget.subscribe("ready", readyCallback());

  //
</script>
</head>
<body>
<div>
Testing custom widget
</div>
<button type="button" onclick="postUp(this.value)" value="Test button data">Test Button</button>
</body>
</html>